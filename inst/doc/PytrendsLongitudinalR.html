<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>PytrendsLongitudinalR</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">PytrendsLongitudinalR</h1>



<p>Welcome to the vignette for PytrendsLongitudinalR, a package for
collecting and analyzing Google Trends data over time. This vignette
will guide you through the setup process and show you how to use the
package’s main functionalities.</p>
<p>This is a package for downloading cross-section and time-series
Google Trends and converting them to longitudinal data. Although Google
Trends provides cross-section and time-series search data, longitudinal
Google Trends data are not readily available. There exist several
practical issues that make it difficult for researchers to generate
longitudinal Google Trends data themselves. First, Google Trends
provides normalized counts from zero to 100. As a result, combining
different regions’ time-series Google Trends data does not create
desired longitudinal data. For the same reason, combining
cross-sectional Google Trends data over time does not create desired
longitudinal data. Second, Google Trends has restrictions on data
formats and timeline. For instance, if you want to collect daily data
for 2 years, you cannot do so. Google Trends automatically provides
weekly data if your request timeline is more than 269 days. Similarly,
Google Trends automatically provides monthly data if your request
timeline is more than 269 weeks even though you want to collect weekly
data. This package resolves the aforementioned issues and allows
researchers to generate longitudinal Google Trends.</p>
<div id="installation" class="section level2">
<h2>Installation</h2>
<p>Make sure Python is installed on your system. You can download from
www.python.org/downloads, or call the install_python() from
reticulate.</p>
<p>Finally, load the library and call install_pytrendslongitudinalr()
function to install PytrendsLongitudinalR. This will automatically
create an isolated virtual environment named “pytrends-in-r-new”</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(PytrendsLongitudinalR)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">install_pytrendslongitudinalr</span>(<span class="at">envname =</span> <span class="st">&quot;pytrends-in-r-new&quot;</span>)</span></code></pre></div>
</div>
<div id="usage" class="section level2">
<h2>Usage</h2>
<p>Now you can start using PytrendsLongitudinalR to collect Google
Trends data.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(PytrendsLongitudinalR)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co"># Initialize parameters for data collection</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">initialize_request_trends</span>(</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="at">keyword =</span> <span class="st">&quot;Coronavirus disease 2019&quot;</span>,</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="at">topic =</span> <span class="st">&quot;/g/11j2cc_qll&quot;</span>,</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  <span class="at">folder_name =</span> <span class="fu">file.path</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;test_folder&quot;</span>),</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  <span class="at">start_date =</span> <span class="st">&quot;2024-05-01&quot;</span>,</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  <span class="at">end_date =</span> <span class="st">&quot;2024-05-03&quot;</span>,</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  <span class="at">data_format =</span> <span class="st">&quot;daily&quot;</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>)</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co"># Collect cross-section data</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="fu">cross_section</span>(params, <span class="at">geo =</span> <span class="st">&quot;US&quot;</span>, <span class="at">resolution =</span> <span class="st">&quot;REGION&quot;</span>) <span class="co"># REGION as a resolution is a sub-region of US in this example, and it indicates US states.</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co"># Collect reference time-series data</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="fu">time_series</span>(params, <span class="at">reference_geo_code =</span> <span class="st">&quot;US-CA&quot;</span>) <span class="co"># The selected reference is California and its Google Trends Geo is &#39;US-CA&#39;.</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co"># Given the short time period in this example, no concatenation is needed.</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="fu">concat_time_series</span>(params, <span class="at">reference_geo_code =</span> <span class="st">&quot;US&quot;</span>, <span class="at">zero_replace =</span> <span class="fl">0.1</span>) <span class="co"># Error occurs because given period is less than 269 days, concatenation is unnecessary. You can move to convert_cross_section() without any problems.</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co"># Use the reference time-series data to re-scale the cross-sectional data. </span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="fu">convert_cross_section</span>(params, <span class="at">reference_geo_code =</span> <span class="st">&quot;US-CA&quot;</span>)</span></code></pre></div>
</div>
<div id="warning" class="section level2">
<h2>WARNING</h2>
<p>We recommend that the user run the functions in the following
sequence:</p>
<p>cross_section</p>
<p>time_series</p>
<p>concat_time_series</p>
<p>convert_time_series</p>
<p>First, the cross-sectional and reference time-series data must be
created. The concat_time_series() function uses the reference
time-series data files to concatenate multiple sets of time series.
Finally, the convert_time_series() function uses the concatenated
reference time series to re-scale the cross-sectional data.</p>
<p>The user may encounter a 429 Too Many Requests error when using
cross_section() and time_series() to collect Google Trends data. This
error indicates that the user has exceeded the rate limits set by the
Google Trends API. Here are a few strategies to mitigate the impact of
this error:</p>
<ol style="list-style-type: decimal">
<li><p>Lower the frequency of your requests or extend the interval
between requests. If you’re making requests with high frequency,
consider spacing them out or reducing the number of requests made in a
given time frame.</p></li>
<li><p>If you’re querying a large time range or a high-resolution
granularity, try reducing the scope of your queries. Smaller time
periods and/or lower resolution might help stay within the rate
limits.</p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
